<!DOCTYPE html>
    <html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Formulaire de retours utilisateurs CompanIA</title>
            <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
<link rel="stylesheet" href="main.css">
    </head>
    <body class="bg-gradient-to-br from-slate-900 to-black min-h-screen p-4 text-white flex flex-row md:items-center justify-center">
        <div class="container mx-auto max-w-xl flex flex-col gap-4 bg-white/5 rounded-xl p-10 py-16 ">
            <h2 class="text-center text-xl font-bold pb-4">Votre retour sur CompanIA</h2>
            <form action="/suivi" method="post">
                
                <label>Identifiant du rapport :</label>
                <input type="text" id="id_rapport" name="id_rapport" list="id_rapport_list" placeholder = "Sélectionnez l'identifiant de votre rapport transmis dans le mail...">
                <datalist id="id_rapport_list">
                    {% for id in all_id %}
                        <option value="{{ id }}">
                    {% endfor %}
                </datalist>                

                <label class="mt-4">Note avec étoiles :</label>
                <div class="star-rating">
                    <span data-value="5" class="star full">&#9733;</span>
                    
                    <span data-value="4" class="star full">&#9733;</span>
                    
                    <span data-value="3" class="star full">&#9733;</span>
                    
                    <span data-value="2" class="star full">&#9733;</span>
                    
                    <span data-value="1" class="star full">&#9733;</span>
                    
                </div>
                <input type="hidden" name="rating_etoiles" id="rating_etoiles">

                <!--<label>Temps économisé grâce à l'outil :</label>            
                <input type="text" name="temps_gagne" placeholder="Exemple : écrivez '1.5' si vous avez gagné 1h30">

                <label>Commentaire :</label>
                <textarea name="commentaire" placeholder="Commentaire..."></textarea>-->
                

                <button class="mt-4" type="submit">Exécuter</button>
                <div class="pt-4 text-center">
                  <a  href="{{ url_for('index') }}" style="text-decoration: none;">
                    ⬅️ Retour au formulaire principal
                  </a>
                </div>
                
            </form>
        </div>
        <script>
            document.getElementById('rating_etoiles').value = 5;
            const stars = document.querySelectorAll('.star-rating .star');
            const ratingInput = document.getElementById('rating_etoiles');

            stars.forEach(star => {
                star.addEventListener('click', () => {
                    const value = parseFloat(star.getAttribute('data-value'));
                    ratingInput.value = value;

                    // Visuel : reset puis ajout de "selected"
                    stars.forEach(s => s.classList.remove('selected'));
                    stars.forEach(s => {
                        if (parseFloat(s.getAttribute('data-value')) <= value) {
                            s.classList.add('selected');
                        }
                    });
                });
            });
            
            const inputID = document.getElementById('id_rapport');
            const datalist = document.getElementById('id_rapport_list');

            inputID.addEventListener('input', function() {
                const value = inputID.value.toLowerCase();
                const options = datalist.getElementsByTagName('option');
                
                
                Array.from(options).forEach(option => {
                    const optionValue = option.value.toLowerCase();
                    if (optionValue.indexOf(value) === -1) {
                        option.style.display = 'none'; // Masque l'option si elle ne correspond
                    } else {
                        option.style.display = 'block'; // Affiche l'option si elle correspond
                    }
                });
            });
        </script>
        
    </body>
    </html>
    